<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Quick Example · Passive TCP fingerprint</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="generator" content="Docusaurus" />
  <meta name="description" content="Following is an example showing how to:" />
  <meta name="docsearch:language" content="en" />
  <meta property="og:title" content="Quick Example · Passive TCP fingerprint" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://fd4s.github.io/passivetcp-rs/passivetcp-rs/" />
  <meta property="og:description" content="Following is an example showing how to:" />
  <meta name="twitter:card" content="summary" />
  <link rel="shortcut icon" href="/passivetcp-rs/img/favicon.png" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <script src="/passivetcp-rs/js/scrollSpy.js"></script>
  <link rel="stylesheet" href="/passivetcp-rs/css/main.css" />
  <script src="/passivetcp-rs/js/codetabs.js"></script>
</head>
<body class="sideNavVisible separateOnPageNav">
<div class="fixedHeaderContainer">
  <div class="headerWrapper wrapper">
    <header>
      <a href="/passivetcp-rs/">
        <img class="logo" src="/passivetcp-rs/img/passivetcp-rs.white.svg" alt="Passive TCP fingerprint" />
        <h2 class="headerTitleWithLogo">Passive TCP fingerprint</h2>
      </a>
      <div class="navigationWrapper navigationSlider">
        <nav class="slidingNav">
          <ul class="nav-site nav-site-internal">
            <li class="siteNavGroupActive"><a href="/passivetcp-rs/docs/overview" target="_self">Documentation</a></li>
            <li class=""><a href="https://github.com/biandratti/passivetcp-rs" target="_self">GitHub</a></li>
          </ul>
        </nav>
      </div>
    </header>
  </div>
</div>
<div class="navPusher">
  <div class="docMainWrapper wrapper">
    <div class="docsNavContainer" id="docsNav">
      <nav class="toc">
        <div class="toggleNav">
          <section class="navWrapper wrapper">
            <div class="navBreadcrumb wrapper">
              <div class="navToggle" id="navToggler">
                <div class="hamburger-menu">
                  <div class="line1"></div>
                  <div class="line2"></div>
                  <div class="line3"></div>
                </div>
              </div>
              <h2><i>›</i><span>Documentation</span></h2>
              <div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div>
            </div>
            <div class="navGroups">
              <div class="navGroup">
                <h3 class="navGroupCategoryTitle">Documentation</h3>
                <ul class="">
                  <li class="navListItem"><a class="navItem" href="/passivetcp-rs/docs/overview">Overview</a></li>
                  <li class="navListItem navListItemActive"><a class="navItem" href="/passivetcp-rs/docs/quick-example">Quick Example</a></li>
                </ul>
              </div>
            </div>
          </section>
        </div>
        <script>
          var coll = document.getElementsByClassName("collapsible");
          var checkActiveCategory = true;
          for (var i = 0; i < coll.length; i++) {
            var links = coll[i].nextElementSibling.getElementsByTagName("*");
            if (checkActiveCategory) {
              for (var j = 0; j < links.length; j++) {
                if (links[j].classList.contains("navListItemActive")) {
                  coll[i].nextElementSibling.classList.toggle("hide");
                  coll[i].childNodes[1].classList.toggle("rotate");
                  checkActiveCategory = false;
                  break;
                }
              }
            }

            coll[i].addEventListener("click", function () {
              var arrow = this.childNodes[1];
              arrow.classList.toggle("rotate");
              var content = this.nextElementSibling;
              content.classList.toggle("hide");
            });
          }

          document.addEventListener("DOMContentLoaded", function () {
            createToggler("#navToggler", "#docsNav", "docsSliderActive");
            createToggler("#tocToggler", "body", "tocActive");

            var headings = document.querySelector(".toc-headings");
            headings &&
            headings.addEventListener(
                    "click",
                    function (event) {
                      var el = event.target;
                      while (el !== headings) {
                        if (el.tagName === "A") {
                          document.body.classList.remove("tocActive");
                          break;
                        } else {
                          el = el.parentNode;
                        }
                      }
                    },
                    false
            );

            function createToggler(togglerSelector, targetSelector, className) {
              var toggler = document.querySelector(togglerSelector);
              var target = document.querySelector(targetSelector);

              if (!toggler) {
                return;
              }

              toggler.onclick = function (event) {
                event.preventDefault();

                target.classList.toggle(className);
              };
            }
          });
        </script>
      </nav>
    </div>
    <div class="container mainContainer docsContainer">
      <div class="wrapper">
        <div class="post">
          <header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Quick Example</h1></header>
          <article>
            <div>
                                    <span>
                                        <p>Following is an example showing how to:</p>
                                        <ul>
                                            <li>use <code>KafkaConsumer#records</code> in order to stream records from Kafka,</li>
                                            <li>use <code>produce</code> to produce newly created records to Kafka,</li>
                                            <li>use <code>commitBatchWithin</code> to commit consumed offsets in batches.</li>
                                        </ul>
                                        <pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> cats.effect.{<span class="hljs-type">IO</span>, <span class="hljs-type">IOApp</span>}
<span class="hljs-keyword">import</span> fs2._
<span class="hljs-keyword">import</span> fs2.kafka._
<span class="hljs-keyword">import</span> fs2.kafka.consumer.<span class="hljs-type">KafkaConsumeChunk</span>.<span class="hljs-type">CommitNow</span>

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Main</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">IOApp</span>.<span class="hljs-title">Simple</span> </span>{

  <span class="hljs-keyword">val</span> run: <span class="hljs-type">IO</span>[<span class="hljs-type">Unit</span>] = {
    <span class="hljs-keyword">val</span> consumerSettings =
      <span class="hljs-type">ConsumerSettings</span>[<span class="hljs-type">IO</span>, <span class="hljs-type">String</span>, <span class="hljs-type">String</span>]
        .withAutoOffsetReset(<span class="hljs-type">AutoOffsetReset</span>.<span class="hljs-type">Earliest</span>)
        .withBootstrapServers(<span class="hljs-string">"localhost:9092"</span>)
        .withGroupId(<span class="hljs-string">"group"</span>)

    <span class="hljs-keyword">val</span> producerSettings =
      <span class="hljs-type">ProducerSettings</span>[<span class="hljs-type">IO</span>, <span class="hljs-type">String</span>, <span class="hljs-type">String</span>].withBootstrapServers(<span class="hljs-string">"localhost:9092"</span>)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">processRecords</span></span>(
      producer: <span class="hljs-type">KafkaProducer</span>[<span class="hljs-type">IO</span>, <span class="hljs-type">String</span>, <span class="hljs-type">String</span>]
    )(records: <span class="hljs-type">Chunk</span>[<span class="hljs-type">ConsumerRecord</span>[<span class="hljs-type">String</span>, <span class="hljs-type">String</span>]]): <span class="hljs-type">IO</span>[<span class="hljs-type">CommitNow</span>] = {
      <span class="hljs-keyword">val</span> producerRecords = records
        .map(consumerRecord =&gt; <span class="hljs-type">ProducerRecord</span>(<span class="hljs-string">"topic"</span>, consumerRecord.key, consumerRecord.value))
      producer.produce(producerRecords).flatten.as(<span class="hljs-type">CommitNow</span>)
    }

    <span class="hljs-keyword">val</span> stream =
      <span class="hljs-type">KafkaProducer</span>
        .stream(producerSettings)
        .evalMap { producer =&gt;
          <span class="hljs-type">KafkaConsumer</span>
            .stream(consumerSettings)
            .subscribeTo(<span class="hljs-string">"topic"</span>)
            .consumeChunk(chunk =&gt; processRecords(producer)(chunk))
        }

    stream.compile.drain
  }

}
</code></pre>
                                    </span>
            </div>
          </article>
        </div>
        <div class="docs-prevnext">
          <a class="docs-prev button" href="/passivetcp-rs/docs/overview"><span class="arrow-prev">← </span><span>Overview</span></a>
        </div>
      </div>
    </div>
    <nav class="onPageNav"></nav>
  </div>
  <footer class="nav-footer" id="footer">
    <hr class="separator" />
    <section class="copyright">
      Passive TCP Fingerprinting Based on p0f
    </section>
  </footer>
</div>
</body>
</html>
