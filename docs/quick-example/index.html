<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Quick Example · Passive TCP fingerprint</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Docusaurus" />
    <meta name="description" content="Following is an example showing how to:" />
    <meta name="docsearch:language" content="en" />
    <meta property="og:title" content="Quick Example · Passive TCP fingerprint" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://fd4s.github.io/passivetcp-rs/passivetcp-rs/" />
    <meta property="og:description" content="Following is an example showing how to:" />
    <meta name="twitter:card" content="summary" />
    <link rel="shortcut icon" href="/passivetcp-rs/img/favicon.png" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
    <script src="/passivetcp-rs/js/scrollSpy.js"></script>
    <link rel="stylesheet" href="/passivetcp-rs/css/main.css" />
    <script src="/passivetcp-rs/js/codetabs.js"></script>
</head>
<body class="sideNavVisible separateOnPageNav">
<div class="fixedHeaderContainer">
    <div class="headerWrapper wrapper">
        <header>
            <a href="/passivetcp-rs/">
                <img class="logo" src="/passivetcp-rs/img/passivetcp-rs-white.svg" alt="Passive TCP fingerprint" />
                <h2 class="headerTitleWithLogo">Passive TCP fingerprint</h2>
            </a>
            <div class="navigationWrapper navigationSlider">
                <nav class="slidingNav">
                    <ul class="nav-site nav-site-internal">
                        <li class="siteNavGroupActive"><a href="/passivetcp-rs/docs/overview" target="_self">Documentation</a></li>
                        <li class=""><a href="https://github.com/biandratti/passivetcp-rs" target="_self">GitHub</a></li>
                    </ul>
                </nav>
            </div>
        </header>
    </div>
</div>
<div class="navPusher">
    <div class="docMainWrapper wrapper">
        <div class="docsNavContainer" id="docsNav">
            <nav class="toc">
                <div class="toggleNav">
                    <section class="navWrapper wrapper">
                        <div class="navBreadcrumb wrapper">
                            <div class="navToggle" id="navToggler">
                                <div class="hamburger-menu">
                                    <div class="line1"></div>
                                    <div class="line2"></div>
                                    <div class="line3"></div>
                                </div>
                            </div>
                            <h2><i>›</i><span>Documentation</span></h2>
                            <div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div>
                        </div>
                        <div class="navGroups">
                            <div class="navGroup">
                                <h3 class="navGroupCategoryTitle">Documentation</h3>
                                <ul class="">
                                    <li class="navListItem"><a class="navItem" href="/passivetcp-rs/docs/overview">Overview</a></li>
                                    <li class="navListItem navListItemActive"><a class="navItem" href="/passivetcp-rs/docs/quick-example">Quick Example</a></li>
                                    <li class="navListItem"><a class="navItem" href="/passivetcp-rs/docs/syn-ack-packet">SYN and SYN+ACK Packets</a></li>
                                    <li class="navListItem"><a class="navItem" href="/passivetcp-rs/docs//mtu">MTU</a></li>
                                    <li class="navListItem"><a class="navItem" href="/passivetcp-rs/docs/uptime">Uptime</a></li>
                                    <li class="navListItem"><a class="navItem" href="/passivetcp-rs/docs/http">Http request and response</a></li>
                                </ul>
                            </div>
                        </div>
                    </section>
                </div>
                <script>
                    var coll = document.getElementsByClassName("collapsible");
                    var checkActiveCategory = true;
                    for (var i = 0; i < coll.length; i++) {
                        var links = coll[i].nextElementSibling.getElementsByTagName("*");
                        if (checkActiveCategory) {
                            for (var j = 0; j < links.length; j++) {
                                if (links[j].classList.contains("navListItemActive")) {
                                    coll[i].nextElementSibling.classList.toggle("hide");
                                    coll[i].childNodes[1].classList.toggle("rotate");
                                    checkActiveCategory = false;
                                    break;
                                }
                            }
                        }

                        coll[i].addEventListener("click", function () {
                            var arrow = this.childNodes[1];
                            arrow.classList.toggle("rotate");
                            var content = this.nextElementSibling;
                            content.classList.toggle("hide");
                        });
                    }

                    document.addEventListener("DOMContentLoaded", function () {
                        createToggler("#navToggler", "#docsNav", "docsSliderActive");
                        createToggler("#tocToggler", "body", "tocActive");

                        var headings = document.querySelector(".toc-headings");
                        headings &&
                        headings.addEventListener(
                            "click",
                            function (event) {
                                var el = event.target;
                                while (el !== headings) {
                                    if (el.tagName === "A") {
                                        document.body.classList.remove("tocActive");
                                        break;
                                    } else {
                                        el = el.parentNode;
                                    }
                                }
                            },
                            false
                        );

                        function createToggler(togglerSelector, targetSelector, className) {
                            var toggler = document.querySelector(togglerSelector);
                            var target = document.querySelector(targetSelector);

                            if (!toggler) {
                                return;
                            }

                            toggler.onclick = function (event) {
                                event.preventDefault();

                                target.classList.toggle(className);
                            };
                        }
                    });
                </script>
            </nav>
        </div>
        <div class="container mainContainer docsContainer">
            <div class="wrapper">
                <div class="post">
                    <header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Quick Example</h1></header>
                    <article>
                        <div>
    <span>
        <p>Following is an example showing how to:</p>
        <ul>
            <li>Initialize the database and PassiveTCP engine.</li>
            <li>Use subcommands to choose between live network capture or PCAP file analysis.</li>
            <li>Process and log various TCP and HTTP characteristics detected with quality scores.</li>
        </ul>
        <pre><code class="hljs css language-rust"><span class="hljs-keyword">use</span> clap::{Parser, Subcommand};
<span class="hljs-keyword">use</span> passivetcp_rs::db::Database;
<span class="hljs-keyword">use</span> passivetcp_rs::fingerprint_result::FingerprintResult;
<span class="hljs-keyword">use</span> passivetcp_rs::PassiveTcp;
<span class="hljs-keyword">use</span> std::sync::mpsc;
<span class="hljs-keyword">use</span> std::thread;
<span class="hljs-keyword">use</span> tracing::info;

#[derive(Parser, Debug)]
#[command(version, about, long_about = None)]
<span class="hljs-keyword">struct</span> <span class="hljs-title">Args</span> {
    #[command(subcommand)]
    command: Commands,
}

#[derive(Subcommand, Debug)]
<span class="hljs-keyword">enum</span> <span class="hljs-title">Commands</span> {
    Live {
        <span class="hljs-comment">/// Network interface name</span>
        #[arg(short = 'i', long)]
        interface: String,
    },
    Pcap {
        <span class="hljs-comment">/// Path to PCAP file</span>
        #[arg(short = 'f', long)]
        file: String,
    },
}

<span class="hljs-keyword">fn</span> <span class="hljs-title">main</span>() {
    <span class="hljs-keyword">let</span> args = Args::parse();
    <span class="hljs-keyword">let</span> db = Box::leak(Box::new(Database::default()));
    <span class="hljs-keyword">let</span> (sender, receiver) = mpsc::channel();

    thread::spawn(<span class="hljs-keyword">move</span> || {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> passive_tcp = PassiveTcp::new(db, 100);

        <span class="hljs-keyword">let</span> result = <span class="hljs-keyword">match</span> args.command {
            Commands::Live { interface } =&gt; {
                info!(<span class="hljs-string">"Starting live capture on interface: {}"</span>, interface);
                passive_tcp.analyze_network(&amp;interface, sender)
            }
            Commands::Pcap { file } =&gt; {
                info!(<span class="hljs-string">"Analyzing PCAP file: {}"</span>, file);
                passive_tcp.analyze_pcap(&amp;file, sender)
            }
        };

        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> Err(e) = result {
            eprintln!(<span class="hljs-string">"Analysis failed: {}"</span>, e);
        }
    });

    <span class="hljs-comment">// Process results</span>
    <span class="hljs-keyword">for</span> output <span class="hljs-keyword">in</span> receiver {
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> Some(syn) = output.syn {
            info!(<span class="hljs-string">"{}"</span>, syn);
        }
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> Some(syn_ack) = output.syn_ack {
            info!(<span class="hljs-string">"{}"</span>, syn_ack);
        }
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> Some(mtu) = output.mtu {
            info!(<span class="hljs-string">"{}"</span>, mtu);
        }
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> Some(uptime) = output.uptime {
            info!(<span class="hljs-string">"{}"</span>, uptime);
        }
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> Some(http_request) = output.http_request {
            info!(<span class="hljs-string">"{}"</span>, http_request);
        }
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> Some(http_response) = output.http_response {
            info!(<span class="hljs-string">"{}"</span>, http_response);
        }
    }
}

<span class="hljs-comment">// Usage examples:</span>
<span class="hljs-comment">// Live capture: cargo run -- live -i eth0</span>
<span class="hljs-comment">// PCAP analysis: cargo run -- pcap -f traffic.pcap</span>
</code></pre>
    </span>
                        </div>

                    </article>
                </div>
                <div class="docs-prevnext">
                    <a class="docs-prev button" href="/passivetcp-rs/docs/overview"><span class="arrow-prev">← </span><span>Overview</span></a>
                    <a class="docs-next button" href="/passivetcp-rs/docs/syn-ack-packet"><span>SYN and SYN+ACK Packets</span><span class="arrow-next"> →</span></a>
                </div>
            </div>
        </div>
        <nav class="onPageNav"></nav>
    </div>
    <footer class="nav-footer" id="footer">
        <hr class="separator" />
        <section class="copyright">
            Passive TCP Fingerprinting Based on p0f
        </section>
    </footer>
</div>
</body>
</html>
